<!DOCTYPE html>
<html lang="en" dir="ltr" class="ui-accent-red">

<head>
  <!--METADATA-->
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
  <title>BitShift</title>
  <link rel="icon" type="image/svg" href="./assets/logo.png" />
  <link rel="manifest" href="manifest.json" />
  <!-- IOS SUPPORT -->
  <meta name="apple-mobile-web-app-status-bar" />
  <meta name="theme-color" />
  <meta name="apple-mobile-web-app-status-bar-style" />


  <!--REMOVE THESE AND REPLACE WITH ACTUAL debug-->
  <script src="https://cdn.jsdelivr.net/gh/Hyperiooo/Alrt.js@v0.1.2/src/alrt.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Hyperiooo/Alrt.js@v0.1.1/src/alrt.css" />
  <!--COLOR-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.0/chroma.min.js"></script>
  <script src="./scripts/anypalette.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.0/color-thief.umd.js"></script>
  <!--SCRIPTS-->

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="./scripts/supabase/SupabaseCore.js" defer></script>
  <script src="./scripts/popper.min.js"></script>
  <script src="./scripts/Matrix.js" defer></script>
  <script src="./scripts/Shapes.js" defer></script>
  <script src="./scripts/Utils.js" defer></script>
  <script src="./scripts/Ui.js" defer></script>
  <script src="./scripts/Canvas.js" defer></script>
  <script src="./scripts/CloudSync.js" defer></script>
  <script src="./scripts/Tools.js" defer></script>
  <script src="./scripts/Layers.js" defer></script>
  <script src="./scripts/ColorMenu.js" defer></script>
  <script src="./scripts/Transformation.js" defer></script>
  <script src="./scripts/KeyboardInput.js" defer></script>
  <script src="./scripts/Exporter.js" defer></script>
  <script src="./scripts/UndoRedoSystem.js" defer></script>
  <script src="./scripts/Cursor.js" defer></script>
  <script src="./scripts/File.js" defer></script>
  <script src="./scripts/Gestures.js" defer></script>
  <script src="./scripts/Selection.js" defer></script>
  <script src="./scripts/clipper.js" defer></script>
  <script src="./scripts/gif.js"></script>
  <script src="./scripts/Compressor.js" defer></script>
  <script src="./scripts/Transform.js" defer></script>
  <script src="./scripts/panzoom.js" defer></script>
  <script src="./scripts/zoom.js" defer></script>
  <script src="./scripts/anime.js" defer></script>
  
  <script src="https://cdn.jsdelivr.net/gh/FakeDazon/SuperZoom@v0.0.6/src/superzoom.js"></script>
  <script defer type="text/javascript" src="./scripts/DrawCore.js"></script>
  <!--STYLES & FONTS-->
  <link href="https://cdn.jsdelivr.net/gh/Hyperiooo/Hypericons@v0.6.8/fonts/hypericons.css" rel="stylesheet"
    type="text/css" />
  <link rel="stylesheet" href="./styles/main.css" />
  <link rel="stylesheet" href="./styles/alrt-theme.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&family=Roboto:wght@400;500;600;700&display=swap"
    rel="stylesheet" />
</head>

<body>

  <div id="cursor" class="invertBackground"></div>
  <img id="img" />
  <div class="menu">
    <div class="menu-btn" onclick="saveFile(); closeMenu()">Save</div>
    <div class="menu-btn" onclick="openFile(); closeMenu()">Open</div>
    <div class="menu-btn" onclick="openWindow('settings'); closeMenu()">Settings</div>
    <div class="menu-btn" onclick="canvasInterface.recenter(); closeMenu()">Recenter</div>
    <div class="menu-btn" onclick="canvasInterface.clear(); closeMenu()">Clear</div>
  </div>
  <input type="file" id="fileOpenDialog" style="
        display: hidden;
        visibility: hidden;
        height: 0px;
        width: 0px;
        pointer-events: none;
      " accept=".bspr" />
  <div id="tool-settings"></div>
  <div class="color-menu" id="color-menu" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);"
    ondragleave="dragLeaveHandler(event);" ondragend="dragLeaveHandler(event);">
    <div class="color-menu-topbar">
      <div id="color-preview" onclick="colorPreviewClickHandler(event)" ontouchstart="colorPreviewClickHandler(event)">
        <div id="color-previous"></div>
        <div id="color-current"></div>
      </div>
      <button class="color-menu-close-button" onclick="toggleColorPicker()">
        <i class="hi-x"></i>
      </button>
    </div>
    <div id="color-menu-drop-effect">Import Palette</div>
    <div id="color-menu-drop-err">Could Not Import Palette</div>
    <div id="color-menu-picker-panel" class="color-menu-panel color-menu-panel-visible">
      <div class="color-selector" id="color-value" width="200" height="200"
        onmousedown="valueThumb(event);valueDrag(event);" onmousemove="valueDrag(event)" onmouseup="valueEndDrag(event)"
        ontouchstart="valueThumb(event);" ontouchmove="valueDrag(event)" ontouchend="valueEndDrag(event)">
        <div id="color-value-thumb" onmousedown="valueThumb(event);valueDrag(event);" onmousemove="valueDrag(event)"
          onmouseup="valueEndDrag(event)" ontouchstart="valueThumb(event);valueDrag(event);"
          ontouchmove="valueDrag(event)" ontouchend="valueEndDrag(event)"></div>
      </div>
      <div class="color-selector" id="color-hue" width="40" height="200" onmousedown="hueThumb(event);hueDrag(event);"
        onmousemove="hueDrag(event)" onmouseup="hueEndDrag(event)" ontouchstart="hueThumb(event);hueDrag(event);"
        ontouchmove="hueDrag(event)" ontouchend="hueEndDrag(event)">
        <div id="color-hue-thumb" onmousedown="hueThumb(event);hueDrag(event);" onmousemove="hueDrag(event)"
          onmouseup="hueEndDrag(event)" ontouchstart="hueThumb(event);hueDrag(event);" ontouchmove="hueDrag(event)"
          ontouchend="hueEndDrag(event)"></div>
      </div>
    </div>
    <div id="color-menu-value-panel" class="color-menu-panel ">
      <div class="color-slider-section">
        <div class="color-slider-group">
          <p>R</p>
          <div class="color-slider" id="color-r-slider" width="40" height="200" data-color-slider="r">
            <div class="color-slider-thumb" id="color-r-thumb" style="--pos: var(--rp)"></div>
          </div>
          <input class="color-input-num" id="color-rgba-r" value="255" min="0" max="255" type="number" data-color-input
            data-input-num-draggable />
        </div>
        <div class="color-slider-group">
          <p>G</p>
          <div class="color-slider" id="color-g-slider" width="40" height="200" data-color-slider="g">
            <div class="color-slider-thumb" id="color-g-thumb" style="--pos: var(--gp)"></div>
          </div><input class="color-input-num" id="color-rgba-g" value="255" min="0" data-color-input max="255"
            type="number" data-input-num-draggable />
        </div>
        <div class="color-slider-group">
          <p>B</p>
          <div class="color-slider" id="color-b-slider" width="40" height="200" data-color-slider="b">
            <div class="color-slider-thumb" id="color-b-thumb" style="--pos: var(--bp)"></div>
          </div>
          <input class="color-input-num" id="color-rgba-b" value="255" min="0" data-color-input max="255" type="number"
            data-input-num-draggable />
        </div>
      </div>
      <div class="color-slider-section">
        <div class="color-slider-group">
          <p>H</p>
          <div class="color-slider" id="color-h-slider" width="40" height="200" data-color-slider="h">
            <div class="color-slider-thumb" id="color-h-thumb" style="--pos: var(--hp)"></div>
          </div>
          <input class="color-input-num" data-color-input id="color-hsla-h" value="0" min="0" max="360" maxlength="3"
            type="number" data-input-num-draggable data-input-num-unit="Â°" />
        </div>
        <div class="color-slider-group">
          <p>S</p>
          <div class="color-slider" id="color-s-slider" width="40" height="200" data-color-slider="s">
            <div class="color-slider-thumb" id="color-s-thumb" style="--pos: var(--sp)"></div>
          </div>
          <input class="color-input-num" id="color-hsla-s" value="100" min="0" data-color-input max="100" type="number"
            data-input-num-draggable data-input-num-unit="%" />
        </div>

        <div class="color-slider-group">
          <p>L</p>
          <div class="color-slider" id="color-l-slider" width="40" height="200" data-color-slider="l">
            <div class="color-slider-thumb" id="color-l-thumb" style="--pos: var(--lp)"></div>
          </div><input class="color-input-num" id="color-hsla-l" value="100" min="0" data-color-input max="100"
            type="number" data-input-num-draggable data-input-num-unit="%" />

        </div>
      </div>
      <div class="color-slider-section">
        <div class="color-slider-group">
          <p>Hex</p><input id="color-hex" data-color-input type="text" />
        </div>
      </div>

    </div>
    <div id="color-menu-palette-panel" class="color-menu-panel ">
      <div id="palettes" class="drop_zone"></div>
    </div>
    <div id="color-menu-recent-colors">
    </div>
    <div id="color-menu-tabbar">
      <button id="color-mode-picker" class="color-menu-tabbar-button color-menu-tabbar-button-active"
        onclick="setPickerMode('picker')">
        Picker
      </button>
      <button id="color-mode-value" class="color-menu-tabbar-button" onclick="setPickerMode('value')">
        Value
      </button>
      <button id="color-mode-palette" class="color-menu-tabbar-button" onclick="setPickerMode('palette')">
        Palettes
      </button>
    </div>
  </div>
  <div class="layer-menu" id="layer-menu">
    <div class="layer-menu-controls">
      <button class="layer-menu-button">
        <i class="hi-copy"></i>
      </button>
      <button class="layer-menu-button" onclick="activeLayer.delete()">
        <i class="hi-trash"></i>
      </button>
      <button class="layer-menu-button">
        <i class="hi-folder"></i>
      </button>
      <button onclick="newLayer()" class="layer-menu-button">
        <i class="hi-plus-large"></i>
      </button>
    </div>
    <div id="layer-main">
      <div id="layer-position-preview-horizontal"></div>
    </div>
  </div>
  <div id="export-menu" class="export-menu">
    <div class="popup-top-bar">
      <h1>Export</h1>
    </div>
    <div class="popup-column" class="" style="--maxHeight: 136px">
      <span class="popup-input-group">
        <p class="popup-input-title">File Name</p>
        <div class="popup-input-wrap">
          <div class="popup-input-field">
            <input class="popup-input-text" id="export-file-name" type="text" value="canvas" />
            <p class="popup-input-unit" id="export-name-extension">.png</p>
          </div>
        </div>
      </span>
      <span class="popup-input-group">
        <p class="popup-input-title">File Type</p>
        <div class="popup-input-wrap">
          <div class="popup-input-field">
            <select name="type" id="export-file-type" value="png" oninput="document.getElementById('export-name-extension').innerHTML=
                '.' + this.value" class="popup-input-select">
              <option value="png" selected>.png</option>
              <option value="jpeg">.jpeg</option>
              <option value="bmp">.bmp</option>
            </select>
          </div>
        </div>
      </span>
      <span class="popup-input-group">
        <p class="popup-input-title">Scale</p>
        <div class="popup-input-wrap">
          <div class="popup-input-field">
            <select name="type" id="export-scale" value="1" class="popup-input-select">
              <option value="1" selected>1x</option>
              <option value="2">2x</option>
              <option value="3">3x</option>
              <option value="4">4x</option>
              <option value="5">5x</option>
              <option value="6">6x</option>
              <option value="7">7x</option>
              <option value="8">8x</option>
              <option value="9">9x</option>
              <option value="10">10x</option>
              <option value="25">25x</option>
              <option value="50">50x</option>
              <option value="100">100x</option>
            </select>
          </div>
        </div>
      </span>
      <div class="popup-btn-group">
        <button onclick="exportFile()" class="popup-btn popup-btn-imp">
          OK
        </button>
        <button onclick="closeExportMenu()" class="popup-btn">Cancel</button>
      </div>
    </div>
  </div>
  <canvas id="eraserBrushBufferParent"></canvas>
  <div id="canvas-parent" customcursor>
    <svg id="cursorSVG" customcursor>
      <g id="cursorGroup" class="followsPanzoom"></g>
    </svg>
    <svg id="selectionSVG" customcursor>
      <g id="selectionGroup" class="followsPanzoom"></g>
    </svg>
    <div id="layerParent" customcursor>
      <svg id="previewCanvasWrapper" class="layerWrapperWrapper nodelete" customcursor
        xmlns="http://www.w3.org/2000/svg">
        <foreignObject class="drawingCanvas">
          <canvas id="previewcanv" customcursor></canvas>
        </foreignObject>
      </svg>
      <svg id="backgroundCanvasWrapper" class="layerWrapperWrapper nodelete" customcursor
        xmlns="http://www.w3.org/2000/svg" style="--zindex: -1;">
        <foreignObject class="drawingCanvas">
          <canvas  id="bggridcanv" customcursor></canvas>
        </foreignObject>
      </svg>
    </div>
    <svg customcursor id="boundingSVG" class="boundingHidden">
      <g stroke="var(--accent)" id="boundingGroup" class="followsPanzoom" customcursor>
        <g id="rotationBoundingGroup">
          <rect customcursor id="boundingRect" x="10" y="10" width="100" height="100" fill="none" />
          <line customcursor id="boundingRotLine" x1="60" y1="-5" x2="60" y2="10" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-bl" cx="10" cy="10" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-br" cx="110" cy="10" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-tl" cx="10" cy="110" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-tr" cx="110" cy="110" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-bm" cx="60" cy="10" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-ml" cx="10" cy="60" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-tm" cx="60" cy="110" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-mr" cx="110" cy="60" r="5"
            fill="white" />
          <circle customcursor class="boundingRectCircleHandle boundingRectHandle-rot" cx="60" cy="-5" r="5"
            fill="white" />
        </g>
      </g>
    </svg>
    <div id="input-layer" customcursor></div>
  </div>
  <canvas id="viewport"></canvas>

  <div id="topbar" class="ui">
    <div id="topbar-left">
      <span class="item" onclick="openGallery()"><i class="hi-carat-left"></i></span>
      <button class="topbar-button" onclick="toggleMenu()">File</button>
      <button class="item" onclick="openExportMenu()" id="exportButton">
        <i class="hi-export"></i>
      </button>
    </div>

    <input type="text" id="topbar-project-name" value="" onblur="renameProject(this)" />

    <div id="tool-settings-content"></div>
    <div id="topbar-right">

      <span class="item" onclick="openGallery()">
        <i class="hi-cloud"></i>
        <i id="syncStatusIndicator" class="hi-loading-outline icon-accent"></i>
      </span>
      <span class="toolbar-divider"></span>
      <span class="item" onclick="undo()"><i class="hi-undo"></i></span>
      <span class="item" onclick="redo()"><i class="hi-redo"></i></span>
      <span class="toolbar-divider"></span>
      <span id="layer-toggle-button" class="item" onclick="toggleLayerMenu()"><i class="hi-layer"></i></span>
    </div>
  </div>
  <div id="actionButtons" class="actionButtonsHidden"></div>
  <div id="toolbar" class="ui">
    <div id="dynamic-tool-wrap"></div>
    <span class="toolbar-divider"></span>
    <span class="item toolbar-landscape-only" onclick="toggleColorPicker()"><i class="hi-circle-small-fill"
        data-tool-color-menu-button></i>
    </span>
    <span id="tool-btn-eyedropper" class="item" data-tool-name="eyedropper"
      onclick="previousTool = getTool();compileForEyedropper(); setTool('eyedropper', this)"><i
        class="hi-eyedropper"></i></span>
    
  </div>

  <div id="window-settings" class="window-wrap window-closed">
    <div class="window-content">
      <button class="window-close" onclick="closeWindow('settings')">
        <i class="hi-x"></i>
      </button>
      <div class="window-sidebar">
        <h1>Settings</h1>
        <button class="window-sidebar-button window-sidebar-button-active">
          <i class="hi-gear"></i>
          <p>General</p>
        </button>
        <button class="window-sidebar-button">
          <i class="hi-ui-line"></i>
          <p>Interface</p>
        </button>
        <button class="window-sidebar-button">
          <i class="hi-pencil"></i>
          <p>Input</p>
        </button><button class="window-sidebar-button">
          <i class="hi-keyboard-line"></i>
          <p>Keybinds</p>
        </button>
        <button class="window-sidebar-button">
          <i class="hi-account-fill"></i>
          <p>Account</p>
        </button>
        <button class="window-sidebar-button">
          <i class="hi-info-line"></i>
          <p>About</p>
        </button>
        <button class="window-sidebar-button">
          <i class="hi-help-line"></i>
          <p>Help</p>
        </button>
      </div>
      <div class="window-main">
        <div class="window-header">
          <h1>General</h1>
        </div>
        <div class="window-inner">
          <span class="window-input-group">
            <p class="window-input-title">Theme</p>
            <div class="window-input-wrap">
              <div class="window-btn-group">
                <button id="ui-theme-light" onclick="setTheme(Themes.light)" class="window-btn theme-button">
                  Light
                </button>
                <button id="ui-theme-dark" onclick="setTheme(Themes.dark)" class="window-btn theme-button">
                  Dark
                </button>
                <button id="ui-theme-system-default" onclick="setTheme(Themes.system)" class="window-btn theme-button">
                  System Theme
                </button>
              </div>
            </div>
          </span>
          <span class="window-input-group">
            <p class="window-input-title">Accent Color</p>
            <div class="window-input-wrap">
              <div class="window-btn-group">
                <button id="ui-accent-red" onclick="setAccent(Accents.red)" class="window-btn accent-button">
                </button><button id="ui-accent-orange" onclick="setAccent(Accents.orange)"
                  class="window-btn accent-button">
                </button><button id="ui-accent-yellow" onclick="setAccent(Accents.yellow)"
                  class="window-btn accent-button">
                </button><button id="ui-accent-green" onclick="setAccent(Accents.green)"
                  class="window-btn accent-button">
                </button>
                <button id="ui-accent-teal" onclick="setAccent(Accents.teal)" class="window-btn accent-button">
                </button><button id="ui-accent-blue" onclick="setAccent(Accents.blue)" class="window-btn accent-button">
                </button><button id="ui-accent-purple" onclick="setAccent(Accents.purple)"
                  class="window-btn accent-button">
                </button><button id="ui-accent-pink" onclick="setAccent(Accents.pink)" class="window-btn accent-button">
                </button>

              </div>
            </div>
          </span>
        </div>
      </div>
    </div>
  </div>
  <div id="eyedropper-preview">
    <img src="./assets/cursors/crosshair.png" alt="" />
    <div id="eyedropper-canvas-parent"><canvas id="eyedropperPreviewCanvas"></canvas></div>
    <div id="eyedropper-preview-current"></div>
    <div id="eyedropper-preview-previous"></div>
  </div>
  <div id="action-blob"></div>
  <div class="number-pad-input-wrap number-pad-input-hidden" data-show id="number-pad">
    <div id="numpadArrow" class="popperArrow" data-popper-arrow>
      <div class="popperArrowInner"></div>
    </div>
    <div class="number-pad-preview grid-row-1 grid-col-1-4"><span id="number-pad-preview-value">1</span><span
        id="number-pad-preview-unit" class="number-pad-unit">px</span></div>
    <button class="number-pad-input-button grid-row-2 grid-col-1" data-value="7">7</button>
    <button class="number-pad-input-button grid-row-2 grid-col-2" data-value="8">8</button>
    <button class="number-pad-input-button grid-row-2 grid-col-3" data-value="9">9</button>
    <button class="number-pad-input-button grid-row-3 grid-col-1" data-value="4">4</button>
    <button class="number-pad-input-button grid-row-3 grid-col-2" data-value="5">5</button>
    <button class="number-pad-input-button grid-row-3 grid-col-3" data-value="6">6</button>
    <button class="number-pad-input-button grid-row-4 grid-col-1" data-value="1">1</button>
    <button class="number-pad-input-button grid-row-4 grid-col-2" data-value="2">2</button>
    <button class="number-pad-input-button grid-row-4 grid-col-3" data-value="3">3</button>
    <button class="number-pad-input-button grid-row-5 grid-col-1-3" data-value="0">0</button>
    <button class="number-pad-input-button grid-col-4 grid-row-2-3 font-icon" data-backspace><i
        class="hi-backspace-line"></i></button>
    <button class="number-pad-input-button grid-col-4 grid-row-4-5 bg-important-t font-icon" data-confirm><i
        class="hi-check"></i></button>
  </div>
</body>

</html>